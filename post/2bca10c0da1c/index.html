<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>沧海拾贝 | Eclipse 4 RCP窗口居中-使用LifeCycleHandler</title>
    <meta content="谨以此文纪念我们逝去的青春。在 ERP 年代，使用 Eclipse RCP 进行跨平台桌面应用开发是一个非常不错的选择。本文是作者去年中忆苦思甜时，遇到 Eclipse 4 RCP 窗口居中的问题.." name="description">
    <meta content="java,spring boot,spring cloud,istio,python,react,vue,区块链,k8s,微服务,服务网格,深度学习,AI,机器学习" name="keywords">
    <link rel="icon" href="/assets/img/favicon.png">
    <link href="/assets/css/style.css" rel="stylesheet"/>
    <link href="/assets/css/main.css" rel="stylesheet"/>
    <link href="//cdn.bootcss.com/highlight.js/11.7.0/styles/vs2015.min.css" rel="stylesheet"/>
</head>
<body class="home">
<header id="header" class="header fixed-top d-flex align-items-center">
    <div class="container-fluid container-lg d-flex align-items-center position-relative">
        <a href="/" rel="home" title="沧海拾贝 | 个人开发技术分享"
           class="me-auto">
            <img alt="scut.tech" src="/assets/img/logo.png" width="214" height="30">
        </a>
        <nav id="navbar" class="navbar">
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="https://www.scut.tech/privacy">License</a></li>
                <li><a href="https://www.scut.tech/contact">Contact</a></li>
<!--                <li><a href="/members" class="memberarea ">-->
<!--                    <svg class="icon icon-user2" fill="currentColor">-->
<!--                        <use th:href="@{/assets/img/icons.svg#user2}"></use>-->
<!--                    </svg>-->
<!--                    <span>Members</span></a></li>-->
                <li class="nav-search-form">
                    <form class="search-form d-flex align-items-center ajaxform" data-append="#main" method="POST"
                          action="https://www.scut.tech/search">
                        <input type="text" value="" name="q" placeholder="Search" title="Enter search keyword">
                        <button type="submit" title="Search">
                            <svg class="icon icon-search" fill="currentColor">
                                <use href="/assets/img/icons.svg#search"></use>
                            </svg>
                        </button>
                    </form>
                </li>
            </ul>
        </nav>
        <svg class="icon icon-search search-bar-toggle" fill="currentColor">
            <use href="/assets/img/icons.svg#search"></use>
        </svg>
        <a href="#" class="mobile-nav-toggle mobile-nav-show" title="Toggle Menu">
            <svg class="icon icon-menu" fill="currentColor">
                <use href="/assets/img/icons.svg#menu"></use>
            </svg>
        </a> <a href="#" class="mobile-nav-toggle mobile-nav-hide d-none" title="Close Menu">
        <svg class="icon icon-close" fill="currentColor">
            <use href="/assets/img/icons.svg#close"></use>
        </svg>
    </a></div>
</header>
<main id="main" class="main">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="page-content">
                    <div class="article-list">
                        <ul>
                            <li class="article-item">
                                <h1 class="title">Eclipse 4 RCP窗口居中-使用LifeCycleHandler</h1>
                                <ul class="list-item-action">
                                    <li>
                                        <span>2020-01-03 15:27</span>
                                        <em class="list-item-action-split"></em>
                                    </li>
                                    <li>
                                        <div> 字数 <span class="num">1,984</span>
                                        </div>
                                        <em class="list-item-action-split"></em>
                                    </li>
                                    <li>
                                        阅读 <span class="num">351</span>

                                    </li>
                                </ul>
                                <div class="show_content"><p>最近几年随着互联网技术的发展，特别是出现React等前端组件化技术后，网页开发越来越方便，使用Eclipse RCP技术的开发人员也越来越少了。原本觉得<a href="http://www.vogella.com/tutorials/EclipseRCP/article.html" target="_blank">Eclipse RCP (Rich Client Platform) - Tutorial</a>已经有较详细的文档说明了，更把以前的Eclipse RCP抛掉，没想到这个网站把以前很多高级技术部分的文档改为收费了。最近想学习一下Eclipse 4 RCP，遇到窗口居中的问题，值得记录下来。</p>
1、在plugin.xml文件的product扩展点增加lifeCycleURI内容如下：
<pre><code>
&lt;xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;&gt;
&lt;eclipse version=&quot;3.4&quot;&gt;
&lt;plugin&gt;
   &lt;extension
         id=&quot;product&quot;
         point=&quot;org.eclipse.core.runtime.products&quot;&gt;
      &lt;product
            application=&quot;org.eclipse.e4.ui.workbench.swt.E4Application&quot;
            name=&quot;tech.scut.e4.rcp&quot;&gt;
         &lt;property
               name=&quot;lifeCycleURI&quot;
               value=&quot;bundleclass://tech.scut.e4.rcp/tech.scut.e4.rcp.E4LifeCycle&quot;&gt;
         &lt;/property&gt;
         &lt;property
               name=&quot;applicationCSS&quot;
               value=&quot;platform:/plugin/tech.scut.e4.rcp/css/default.css&quot;&gt;
         &lt;/property&gt;
         &lt;property
               name=&quot;appName&quot;
               value=&quot;tech.scut.e4.rcp&quot;&gt;
         &lt;/property&gt;
      &lt;/product&gt;
   &lt;/extension&gt;
&lt;/plugin&gt;
</code></pre>

2、E4LifeCycle类内容如下，其中MWINDOW_ID为Application.e4xmi里的Trimmed Window的ID：
<pre><code>
package tech.scut.e4.rcp;
 
import org.eclipse.e4.core.contexts.IEclipseContext;
import org.eclipse.e4.ui.model.application.MApplication;
import org.eclipse.e4.ui.model.application.ui.basic.MTrimmedWindow;
import org.eclipse.e4.ui.model.application.ui.basic.MWindow;
import org.eclipse.e4.ui.workbench.lifecycle.PostContextCreate;
import org.eclipse.e4.ui.workbench.lifecycle.PreSave;
import org.eclipse.e4.ui.workbench.lifecycle.ProcessAdditions;
import org.eclipse.e4.ui.workbench.lifecycle.ProcessRemovals;
import org.eclipse.e4.ui.workbench.modeling.EModelService;
import org.eclipse.swt.graphics.Rectangle;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Monitor;
 
/**
 * This is a stub implementation containing e4 LifeCycle annotated
 * methods.<br />
 * There is a corresponding entry in <em>plugin.xml</em> (under the
 * <em>org.eclipse.core.runtime.products' extension point</em>) that references
 * this class.
 **/
public class E4LifeCycle {
    public static final String MWINDOW_ID="tech.scut.e4.rcp.window.main";
 
    @PostContextCreate
    void postContextCreate(IEclipseContext workbenchContext) {
    }
 
    @PreSave
    void preSave(IEclipseContext workbenchContext) {
    }
 
    @ProcessAdditions
    void processAdditions(MApplication app, EModelService modelService) {
MTrimmedWindow window=(MTrimmedWindow)modelService.find(MWINDOW_ID, app);
 
        // 窗口居中
        Display display = Display.getDefault();
        this.setLocation(display, window);
    }
 
    /**
     * 窗口居中
     * 
     * @param display
     * @param window
     */
    private void setLocation(Display display, MWindow window) {
        Monitor monitor = display.getPrimaryMonitor();
        Rectangle monitorRect = monitor.getBounds();
        int x=monitorRect.x+(monitorRect.width-window.getWidth())/2;
        int y=monitorRect.y+(monitorRect.height-window.getHeight())/2;
        window.setX(x);
        window.setY(y);
    }
 
    @ProcessRemovals
    void processRemovals(IEclipseContext workbenchContext) {
    }
}
</code></pre>
至此，完成E4 RCP的窗口居中。</div>
                            </li>
                        </ul>
                    </div>
                </div>
                <ul class="pager">
                    <li class="previous"><a
                            href="/post/2f5cf45b7b51">&larr;
                        <span>Ant Design of React项目实战</span> </a>
                    </li>
                    <li class="next">
                        <a href="/post/2b7db5bbc709"><span>JPA使用Example查询结果为空的问题</span>
                            &rarr;</a>
                    </li>
                </ul>
            </div>
            <div class="col-lg-4">
                <div class="aside">
                    <h4 class="title">推荐阅读</h4>
                    <ul>
                        <li class="article-item">
                            <a href="/post/26ec819006cb" title="使用 vue-cli4 配置打包优化">
                                <span>使用 vue-cli4 配置打包优化</span>
                            </a>
                        </li>
                        <li class="article-item">
                            <a href="/post/b63030f351d1" title="Ant Design Pro 4.0动态菜单图标显示">
                                <span>Ant Design Pro 4.0动态菜单图标显示</span>
                            </a>
                        </li>
                        <li class="article-item">
                            <a href="/post/b61711975b9c" title="Ant Design Pro 4.0从服务器请求菜单">
                                <span>Ant Design Pro 4.0从服务器请求菜单</span>
                            </a>
                        </li>
                        <li class="article-item">
                            <a href="/post/2bca10c0da1c" title="Eclipse 4 RCP窗口居中-使用LifeCycleHandler">
                                <span>Eclipse 4 RCP窗口居中-使用LifeCycleHandler</span>
                            </a>
                        </li>
                        <li class="article-item">
                            <a href="/post/2b7db5bbc709" title="JPA使用Example查询结果为空的问题">
                                <span>JPA使用Example查询结果为空的问题</span>
                            </a>
                        </li>
                        <li class="article-item">
                            <a href="/post/b600f0256196" title="Spring Cloud Gateway获取POST请求内容">
                                <span>Spring Cloud Gateway获取POST请求内容</span>
                            </a>
                        </li>
                        <li class="article-item">
                            <a href="/post/2f5cf45b7b51" title="Ant Design of React项目实战">
                                <span>Ant Design of React项目实战</span>
                            </a>
                        </li>
                        <li class="article-item">
                            <a href="/post/27626b08146b" title="Vue预渲染卡在Building fresh packages...">
                                <span>Vue预渲染卡在Building fresh packages...</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</main>
<footer id="footer" class="footer">
    <div class="copyright text-center">
        ©2023 scut.tech
        <a href="https://beian.miit.gov.cn/" target="_blank"
           class="text">粤ICP备19159625号</a></div>
</footer>
<div title="Search" class="search-bar d-none">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <form class="search-form d-flex align-items-center ajaxform" data-append="#main" method="POST"
                      action="https://www.scut.tech/search">
                    <input type="text" value="" name="q" placeholder="Search" title="Enter search keyword">
                    <button type="submit" title="Search">
                        <svg class="icon icon-search" fill="currentColor">
                            <use href="/assets/img/icons.svg#search"/>
                        </svg>
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
<a href="#" class="scroll-top" title="Back to top">
    <img alt="back_to_top" class="icon icon-arrow-up" fill="currentColor"
         src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAoCAYAAACWwljjAAAABGdBTUEAALGPC/xhBQAAAbtJREFUWAntmMtKw0AUhhMvS5cuxILgQlRUpIggIoKIIoigG1eC+AA+jo+i6FIXBfeuXIgoeKVeitVWJX5HWhhDksnUpp3FDPyZk3Nm5nycmZKkXhAEOXSA3lG7muTeRzmfy6HneUvIhnYkQK+Q9NhAA0Opg0vBEhjBKHiyb8iGMyQMOYuK41BcBSypAL+MYXSKjtFAW7EAGEO3qN4uMQbbAkXiSfRQJ1H6a+yhlkKRcAoVFYiweYNjtCVQJJpBz2GCiPt7fBOZQpFgDpUikse5HgnkM4Fi4QX0Fpc5wf9EbLqpUCy4jMoJSXWhFwbMNgWKhVbRhy5jirhs9fy/oFhgHVVTJEs7RLZ8sSEoJm6iz7SZDMbJ+/OKERQTttCXQRLToRUmrKWCYuA2+jbN0MB4OQobYShfdTCgn/sL1K36M7TLrN3n+758aPy2rrpR6+/od5E8tf/A1uLS9aId5T7J3CNYihkQ4D9PiMdMC7mp4rjB9kjFjZp8BlnVHJBuO1yFXIV0FdDF3RlyFdJVQBdv5AxVdIsq8apiZ2PyYO1EVykesGfZEESsCkweyR8MUW+V8uJ1gkYipmpdP1pm2aJVPEGzAAAAAElFTkSuQmCC">
</a>
<script src="/assets/js/main.js?v=5.0"></script>
<script src="//cdn.bootcss.com/highlight.js/11.7.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
<script async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9644942625237459"
        crossorigin="anonymous"></script>
</body>
</html>